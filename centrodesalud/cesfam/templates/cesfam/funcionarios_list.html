{% extends 'cesfam/base.html' %}
{% load static %}

{% block title %}Funcionarios - CESFAM{% endblock %}

{% block extra_css %}
<style>
    .funcionario-card {
        transition: transform 0.2s;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }

    .funcionario-card:hover {
        transform: translateY(-5px);
    }

    .funcionario-header {
        background: linear-gradient(45deg, #0056b3, #007bff);
        padding: 1.5rem;
        color: white;
    }

    .avatar-circle {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        background-color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: #007bff;
        margin: 0 auto 1rem;
        font-weight: bold;
    }

    .role-badge {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
        border-radius: 20px;
        background-color: rgba(255, 255, 255, 0.2);
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="fw-bold text-primary mb-4 text-center">Gestión de Funcionarios</h2>

    {% if funcionarios %}
    <div class="row" id="funcionariosList">
        {% for f in funcionarios %}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card funcionario-card">
                <div class="funcionario-header text-center">
                    <div class="avatar-circle">
                        {{ f.first_name|first|upper }}{{ f.last_name|first|upper }}
                    </div>
                    <h5 class="mb-1">{{ f.first_name }} {{ f.last_name }}</h5>
                    <p class="mb-2">{{ f.cargo|default:"Sin cargo" }}</p>
                    <span class="badge role-badge">
                        {{ f.id_rol.nombre|default:"Sin rol" }}
                    </span>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled mb-4">
                        <li class="mb-2"><i class="bi bi-envelope me-2"></i>{{ f.email|default:"No especificado" }}</li>
                        <li class="mb-2"><i class="bi bi-telephone me-2"></i>{{ f.telefono|default:"-" }}</li>
                        <li class="mb-2"><i class="bi bi-building me-2"></i>{{ f.departamento|default:"No asignado" }}</li>
                        <li><i class="bi bi-calendar-check me-2"></i>Estado: {{ f.get_estado_display|default:"-" }}</li>
                    </ul>
                    {% if user.id_rol.nombre|lower in "direccion,subdireccion clínica,subdireccion administrativa" %}
                    <div class="d-flex justify-content-between">
                        <button class="btn btn-outline-primary btn-sm">
                            <i class="bi bi-pencil me-2"></i>Editar
                        </button>
                        <button class="btn btn-outline-secondary btn-sm">
                            <i class="bi bi-three-dots-vertical"></i>
                        </button>
                    </div>
                    {% else %}
                    <button class="btn btn-outline-primary w-100">
                        <i class="bi bi-envelope me-2"></i>Contactar
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center">No hay funcionarios registrados.</p>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info text-center mt-4">
        No hay funcionarios registrados actualmente.
    </div>
    {% endif %}
</div>
{% endblock %}
